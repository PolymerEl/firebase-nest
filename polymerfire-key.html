<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../polymerfire/firebase-document.html">
<!--
`polymerfire-lookup`
polymerfire based util to construct lookup datastructure

@demo demo/index.html 
-->
<dom-module id="polymerfire-key">
  <template>
    <style>
    :host {
      display: block;
    }
    </style>
    <firebase-document data="{{data}}" path="[[path]]" disabled="[[disabled]]" app-name="[[appName]]"></firebase-document>
    <content></content>
  </template>
  <script>
  Polymer({

    is: 'polymerfire-key',

    behaviors: [
      // Polymer.PolymerfireLookupQueyBehavior
    ],

    properties: {
      /**
       * Path to a Firebase root or endpoint. N.B. `path` is case sensitive.
       */ 
      path: {
        type: String 
      },


      /**
       * The data to returned by firebase-query.
       */
      data: {
        type: Object,
        notify: true
      },

      /**
       * When true, Firebase listeners won't be activated. This can be useful
       * in situations where elements are loaded into the DOM before they're
       * ready to be activated (e.g. navigation, initialization scenarios).
       */
      disabled: {
        type: Boolean,
        value: false
      },

      /**
       * `key` the key to add to passed data
       */
      key: {
        type: String,
        value: 'lookup'
      },

      /**
       * `dataRoot` root data that this element will augment
       */
      dataRoot: {
        type: Object
      }
    },

    observers: [
      'observeData(data, key, dataRoot)'
    ],

    observeData: function(data, key, dataRoot) {
      this.set('dataRoot.' + key, data);
      this.fire('polymerfire-key', {
        $key: dataRoot.$key,
        key: key,
        data: data,
        dataRoot: dataRoot
      });
    }

  });
  </script>
</dom-module>
